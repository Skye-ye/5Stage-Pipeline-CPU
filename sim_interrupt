#!/bin/bash

# Interrupt test simulation script
# Tests the interrupt handling functionality

echo "Compiling interrupt test modules..."

# Compile interrupt test
iverilog -I cpu -o interrupt_test.out \
    cpu/def.v cpu/alu.v cpu/ctrl.v cpu/ext.v cpu/rf.v \
    cpu/hazard.v cpu/forward.v cpu/branch.v cpu/interrupt.v cpu/csr.v \
    cpu/timer.v cpu/cpu.v cpu/interrupt_tb.v

if [ $? -ne 0 ]; then
    echo "Compilation failed!"
    exit 1
fi

echo "Running interrupt test simulation..."
vvp interrupt_test.out

echo "Interrupt test simulation complete!"
echo "VCD file: interrupt_test.vcd"
echo "Use 'gtkwave interrupt_test.vcd' to view waveforms"